function schedule(t){jQuery(document).ready((function(e){var n="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",i=e(".csstransitions").length>0;function o(t){this.element=t,this.timeline=this.element.find(".timeline"),this.timelineItems=this.timeline.find("li"),this.timelineItemsNumber=this.timelineItems.length,this.timelineStart=m(this.timelineItems.eq(0).text()),this.timelineUnitDuration=m(this.timelineItems.eq(1).text())-m(this.timelineItems.eq(0).text()),this.eventsWrapper=this.element.find(".events"),this.eventsGroup=this.eventsWrapper.find(".events-group"),this.singleEvents=this.eventsGroup.find(".single-event"),this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.modal=this.element.find(".event-modal"),this.modalHeader=this.modal.find(".header"),this.modalHeaderBg=this.modal.find(".header-bg"),this.modalBody=this.modal.find(".body"),this.modalBodyBg=this.modal.find(".body-bg"),this.modalMaxWidth=800,this.modalMaxHeight=640,this.animating=!1,this.initSchedule()}i||(n="noTransition"),o.prototype.initSchedule=function(){this.scheduleReset(),this.initEvents()},o.prototype.scheduleReset=function(){var e=this.mq();"desktop"==e?(this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.element.addClass("js-full"),this.placeEvents(),this.element.hasClass("modal-is-open")&&this.checkEventModal(),30==t?this.eventsGroup.children("ul").css({height:"3000px"}):this.eventsGroup.children("ul").css({height:"3100px"})):"mobile"==e?(this.element.removeClass("js-full loading"),this.eventsGroup.children("ul").add(this.singleEvents).removeAttr("style"),this.eventsWrapper.children(".grid-line").remove(),this.element.hasClass("modal-is-open")&&this.checkEventModal()):"desktop"==e&&this.element.hasClass("modal-is-open")?(this.checkEventModal("desktop"),this.element.removeClass("loading")):this.element.removeClass("loading")},o.prototype.initEvents=function(){var t=this;this.singleEvents.each((function(){var n,i,o='<span class="event-date">Ngày chụp: '+(n=e(this).data("start"),(i=(n=n.replace(/ /g,"")).split("/"))[0]+"/"+i[1])+"</span>";e(this).children("a").prepend(e(o)),e(this).on("click","a",(function(n){n.preventDefault(),t.animating||t.openModal(e(this))}))})),this.modal.on("click",".close",(function(e){e.preventDefault(),t.animating||t.closeModal(t.eventsGroup.find(".selected-event"))})),this.element.on("click",".cover-layer",(function(e){!t.animating&&t.element.hasClass("modal-is-open")&&t.closeModal(t.eventsGroup.find(".selected-event"))}))},o.prototype.placeEvents=function(){var t=this,n=0;this.singleEvents.each((function(){var i=m(e(this).attr("data-start")),o=m(e(this).attr("data-start")),a=e(this).attr("data-child");1==a?e(this).css({left:"0px"}):2==a?e(this).css({left:"23px"}):e(this).css({right:"0px"}),n=i==o?60:o-i+60;var d=t.eventSlotHeight*(i-t.timelineStart)/t.timelineUnitDuration,s=t.eventSlotHeight*n/t.timelineUnitDuration;e(this).css({top:d-1+"px",height:s+1+"px"})})),this.element.removeClass("loading")},o.prototype.openModal=function(t){var o=this,a=o.mq();if(this.animating=!0,e("body").css("overflow","hidden"),this.modalHeader.find(".event-name-id").text(t.find(".event-name-id").text()),this.modalHeader.find(".event-name").text(t.find(".event-name").text()),this.modalHeader.find(".event-name-unit").text(t.find(".event-name-unit").text()),this.modalHeader.find(".event-date").text(t.find(".event-date").text()),this.modal.attr("data-event",t.parent().attr("data-event")),this.modalBody.find(".event-info").load(t.parent().attr("data-content")+".html .event-info > *",(function(t){o.element.addClass("content-loaded")})),this.modalBody.find(".event-car-id").html(t.find(".event-car-id").html()),this.modalBody.find(".event-id").html(t.find(".event-id").html()),this.modalBody.find(".event-unit").html(t.find(".event-unit").html()),this.modalBody.find(".event-ord-unit").html(t.find(".event-unit").html()),this.modalBody.find(".event-cty-name").html(t.find(".event-cty-name").html()),this.modalBody.find(".event-select").html(t.find(".event-select").html()),this.modalBody.find(".event-address").html(t.find(".event-address").html()),""==t.find(".event-note").html()?this.modalBody.find(".event-note").addClass("hidden"):(this.modalBody.find(".event-note").removeClass("hidden"),this.modalBody.find(".event-note-content").html(t.find(".event-note").html())),this.modalBody.find(".event-list-file").html((function(){var n=t.find(".event-list-file-path").text(),i=t.find(".event-list-file").text();if(""!=n||0!=i){var o=n.split(","),a=i.split(","),d="";return Array.prototype.associate=function(t){var e={};return this.forEach((function(n,i){e[t[i]]=n})),e},e.each(o.associate(a),((t,e)=>{d+='<div class="main-file"><div class="file-content"><div class="file-name">'+t+'</div><div class="file-action"><a href="https://drive.google.com/file/d/'+e+'/view"target="_blank" class="download-file"><i class="far fa-eye"></i></a></div></div></div>'})),'<div class="section-file">'+d+"</div>"}return"Không có danh sách"})),this.modalBody.find(".event-info-contact").html(t.find(".event-info-contact").html()),this.modalBody.find(".event-time").html(t.find(".event-time").html()),this.modalBody.find(".event-quantity").html(t.find(".event-quantity").html()),0!=t.find(".event-quantity-ktv").text()||""!=t.find(".event-note-ktv").text()?(this.modalBody.find(".order-quantity-ktv").val(t.find(".event-quantity-ktv").html()+" Cas"),""!=t.find(".event-quantity-ktv").text()?this.modalBody.find(".order-quantity-ktv").addClass("form-textbox-entered"):this.modalBody.find(".order-quantity-ktv").removeClass("form-textbox-entered"),this.modalBody.find(".order-note-ktv").val(t.find(".event-note-ktv").html()),this.modalBody.find(".order-quantity-ktv").attr("disabled",!0),this.modalBody.find(".order-note-ktv").attr("disabled",!0),this.modalBody.find(".submit-quantity-technologist").attr("disabled",!0).addClass("hidden")):(this.modalBody.find(".order-quantity-ktv").removeClass("form-textbox-entered").val(""),this.modalBody.find(".order-note-ktv").val(""),this.modalBody.find(".order-quantity-ktv").attr("disabled",!1),this.modalBody.find(".order-note-ktv").attr("disabled",!1),this.modalBody.find(".submit-quantity-technologist").attr("disabled",!1).removeClass("hidden")),this.modalBody.find(".event-order-note").html(t.find(".event-order-note").html()),this.modalBody.find(".event-quantity").html(t.find(".event-quantity").html()),this.element.addClass("modal-is-open"),setTimeout((function(){t.parent("li").addClass("selected-event")}),10),"mobile"==a)o.modal.one(n,(function(){o.modal.off(n),o.animating=!1}));else{var d=t.offset().top-e(window).scrollTop(),s=t.offset().left,l=e(window).width(),m=e(window).height(),h=.8*l>o.modalMaxWidth?o.modalMaxWidth:.8*l,f=.8*m>o.modalMaxHeight?o.modalMaxHeight:.8*m,c=parseInt((l-h)/2-s),v=parseInt((m-f)/2-d);o.modal.css({top:d+"px",left:s+"px",height:f+"px",width:h+"px"}),r(o.modal,"translateY("+v+"px) translateX("+c+"px)"),o.modalHeaderBg.one(n,(function(){o.modalHeaderBg.off(n),o.animating=!1,o.element.addClass("animation-completed")}))}i||o.modal.add(o.modalHeaderBg).trigger(n)},o.prototype.closeModal=function(t){var o=this,a=o.mq();if(this.animating=!0,e("body").removeAttr("style"),"mobile"==a)this.element.removeClass("modal-is-open"),this.modal.one(n,(function(){o.modal.off(n),o.animating=!1,o.element.removeClass("content-loaded"),t.removeClass("selected-event")}));else{var d=t.offset().top-e(window).scrollTop(),s=t.offset().left,l=t.innerHeight(),m=t.innerWidth(),h=Number(o.modal.css("top").replace("px","")),f=s-Number(o.modal.css("left").replace("px","")),c=d-h;o.element.removeClass("animation-completed modal-is-open"),this.modal.css({width:m+"px",height:l+"px"}),r(o.modal,"translateX("+f+"px) translateY("+c+"px)"),r(o.modalBodyBg,"scaleX(0) scaleY(1)"),r(o.modalHeaderBg,"scaleY(1)"),this.modalHeaderBg.one(n,(function(){o.modalHeaderBg.off(n),o.modal.addClass("no-transition"),setTimeout((function(){o.modal.add(o.modalHeader).add(o.modalBody).add(o.modalHeaderBg).add(o.modalBodyBg).attr("style","")}),10),setTimeout((function(){o.modal.removeClass("no-transition")}),20),o.animating=!1,o.element.removeClass("content-loaded"),t.removeClass("selected-event")}))}i||o.modal.add(o.modalHeaderBg).trigger(n)},o.prototype.mq=function(){return window.getComputedStyle(this.element.get(0),"::before").getPropertyValue("content").replace(/["']/g,"")},o.prototype.checkEventModal=function(t){this.animating=!0;var n=this,i=this.mq();if("mobile"==i)n.modal.add(n.modalHeader).add(n.modalHeaderBg).add(n.modalBody).add(n.modalBodyBg).attr("style",""),n.modal.removeClass("no-transition"),n.animating=!1;else if("desktop"==i&&n.element.hasClass("modal-is-open")){n.modal.addClass("no-transition"),n.element.addClass("animation-completed");var o=n.eventsGroup.find(".selected-event"),a=(o.offset().top,e(window).scrollTop(),o.offset().left,o.innerHeight(),o.innerWidth(),e(window).width()),d=e(window).height(),s=.8*a>n.modalMaxWidth?n.modalMaxWidth:.8*a,l=.8*d>n.modalMaxHeight?n.modalMaxHeight:.8*d;setTimeout((function(){n.modal.css({width:s+"px",height:l+"px",top:d/2-l/2+"px",left:a/2-s/2+"px"}),r(n.modal,"translateY(0) translateX(0)")}),10),setTimeout((function(){n.modal.removeClass("no-transition"),n.animating=!1}),20)}};var a=e(".cd-schedule"),d=[],s=!1;function l(){d.forEach((function(t){t.scheduleReset()})),s=!1}function m(t){var e=(t=t.replace(/ /g,"")).split("/");return 60*parseInt(e[0])}function r(t,e){t.css({"-moz-transform":e,"-webkit-transform":e,"-ms-transform":e,"-o-transform":e,transform:e})}a.length>0&&a.each((function(){d.push(new o(e(this)))})),e(window).on("resize",(function(){s||(s=!0,window.requestAnimationFrame?window.requestAnimationFrame(l):setTimeout(l))})),e(window).keyup((function(t){27==t.keyCode&&d.forEach((function(t){t.closeModal(t.eventsGroup.find(".selected-event"))}))}))}))}schedule(day),$(".select-month").on("change",(function(){var t=$(this).val(),e=$(".select-year").val();$(".loader-over").fadeIn(),$.ajax({url:url_select_technologist,method:"POST",data:{_token:$('meta[name="csrf-token"]').attr("content"),year:e,month:t},success:function(t){schedule(t.day),$(".cd-schedule").html(t.html),$(".loader-over").fadeOut()}})})),$(".select-year").on("change",(function(){$(".define-month").prop("selected",!0)})),$(document).on("click",".submit-quantity-technologist",(function(){var t=$(".event-info").find(".event-id").text(),e=$(".order-quantity-ktv").val(),n=$(".order-note-ktv").val();$(".loader-over").fadeIn(),$.ajax({url:url_update_technologist,method:"POST",data:{_token:$('meta[name="csrf-token"]').attr("content"),id:t,order_quantity_draft:e,order_note_ktv:n},success:function(){$(".event-modal").fadeOut(),$(".cover-layer").css({opacity:"0"}),$(".loader-over").fadeOut(),successMsg("Bạn đã cập nhật số Cas chụp thành công"),setTimeout((function(){location.reload()}),1e3)}})}));