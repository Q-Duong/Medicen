function schedule(e){jQuery(document).ready((function(t){var n="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",i=t(".csstransitions").length>0;function a(e){this.element=e,this.timeline=this.element.find(".timeline"),this.timelineItems=this.timeline.find("li"),this.timelineItemsNumber=this.timelineItems.length,this.timelineStart=m(this.timelineItems.eq(0).text()),this.timelineUnitDuration=m(this.timelineItems.eq(1).text())-m(this.timelineItems.eq(0).text()),this.eventsWrapper=this.element.find(".events"),this.eventsGroup=this.eventsWrapper.find(".events-group"),this.singleEvents=this.eventsGroup.find(".single-event"),this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.modal=this.element.find(".event-modal"),this.modalHeader=this.modal.find(".header"),this.modalHeaderBg=this.modal.find(".header-bg"),this.modalBody=this.modal.find(".body"),this.modalBodyBg=this.modal.find(".body-bg"),this.modalMaxWidth=800,this.modalMaxHeight=640,this.animating=!1,this.initSchedule()}i||(n="noTransition"),a.prototype.initSchedule=function(){this.scheduleReset(),this.initEvents()},a.prototype.scheduleReset=function(){var t=this.mq();"desktop"==t?(this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.element.addClass("js-full"),this.placeEvents(),this.element.hasClass("modal-is-open")&&this.checkEventModal(),30==e?this.eventsGroup.children("ul").css({height:"3000px"}):this.eventsGroup.children("ul").css({height:"3100px"})):"mobile"==t?(this.element.removeClass("js-full loading"),this.eventsGroup.children("ul").add(this.singleEvents).removeAttr("style"),this.eventsWrapper.children(".grid-line").remove(),this.element.hasClass("modal-is-open")&&this.checkEventModal()):"desktop"==t&&this.element.hasClass("modal-is-open")?(this.checkEventModal("desktop"),this.element.removeClass("loading")):this.element.removeClass("loading")},a.prototype.initEvents=function(){var e=this;this.singleEvents.each((function(){var n,i,a='<span class="event-date">Ngày chụp: '+(n=t(this).data("start"),(i=(n=n.replace(/ /g,"")).split("/"))[0]+"/"+i[1])+"</span>";t(this).children("a").prepend(t(a)),t(this).on("click","a",(function(n){n.preventDefault(),e.animating||e.openModal(t(this))}))})),this.modal.on("click",".close",(function(t){t.preventDefault(),e.animating||e.closeModal(e.eventsGroup.find(".selected-event"))})),this.element.on("click",".cover-layer",(function(t){!e.animating&&e.element.hasClass("modal-is-open")&&e.closeModal(e.eventsGroup.find(".selected-event"))}))},a.prototype.placeEvents=function(){var e=this,n=0;this.singleEvents.each((function(){var i=m(t(this).attr("data-start")),a=m(t(this).attr("data-start")),d=t(this).attr("data-child");1==d?t(this).css({left:"0px"}):2==d?t(this).css({left:"23px"}):t(this).css({right:"0px"}),n=i==a?60:a-i+60;var o=e.eventSlotHeight*(i-e.timelineStart)/e.timelineUnitDuration,s=e.eventSlotHeight*n/e.timelineUnitDuration;t(this).css({top:o-1+"px",height:s+1+"px"})})),this.element.removeClass("loading")},a.prototype.openModal=function(e){var a=this,d=a.mq();const o=new Date,s=new Date(e.find(".event-start-day").html());this.animating=!0,t("body").css("overflow","hidden"),this.modalHeader.find(".event-name-id").text(e.find(".event-name-id").text()),this.modalHeader.find(".event-name").text(e.find(".event-name").text()),this.modalHeader.find(".event-name-unit").text(e.find(".event-name-unit").text()),this.modalHeader.find(".event-date").text(e.find(".event-date").text()),this.modal.attr("data-event",e.parent().attr("data-event")),this.modalBody.find(".event-info").load(e.parent().attr("data-content")+".html .event-info > *",(function(e){a.element.addClass("content-loaded")})),this.modalBody.find(".event-car-id").html(e.find(".event-car-id").html()),this.modalBody.find(".event-id").html(e.find(".event-id").html()),this.modalBody.find(".event-unit").html(e.find(".event-unit").html()),this.modalBody.find(".event-cty-name").html(e.find(".event-cty-name").html()),this.modalBody.find(".event-address").html(e.find(".event-address").html()),this.modalBody.find(".event-note-content").html(e.find(".event-note").html()),this.modalBody.find(".event-select").html(e.find(".event-select").html()),this.modalBody.find(".event-list-file").html((function(){var n=e.find(".event-list-file-path").text(),i=e.find(".event-list-file").text();if(""!=n||0!=i){var a=n.split(","),d=i.split(","),o="";return Array.prototype.associate=function(e){var t={};return this.forEach((function(n,i){t[e[i]]=n})),t},t.each(a.associate(d),((e,t)=>{o+='<div class="main-file"><div class="file-content"><div class="file-name">'+e+'</div><div class="file-action"><a href="https://drive.google.com/file/d/'+t+'/view"target="_blank" class="download-file"><i class="far fa-eye"></i></a></div></div></div>'})),'<div class="section-file">'+o+"</div>"}return"Không có danh sách"})),this.modalBody.find(".event-info-contact").html(e.find(".event-info-contact").html()),this.modalBody.find(".event-time").html(e.find(".event-time").html()),this.modalBody.find(".event-doctor-read").html(e.find(".event-doctor-read").html()),this.modalBody.find(".event-film").html(e.find(".event-film").html()),this.modalBody.find(".event-form").html(e.find(".event-form").html()),this.modalBody.find(".event-print").html(e.find(".event-print").html()),this.modalBody.find(".event-form-print").html(e.find(".event-form-print").html()),this.modalBody.find(".event-print-result").html(e.find(".event-print-result").html()),this.modalBody.find(".event-film-sheet").html(e.find(".event-film-sheet").html()),this.modalBody.find(".event-order-note").html(e.find(".event-order-note").html()),this.modalBody.find(".event-ord-warning").html(e.find(".event-warning").html()),this.modalBody.find(".event-deadline").html(e.find(".event-deadline").html()),this.modalBody.find(".event-deliver-results").html(e.find(".event-deliver-results").html()),this.modalBody.find(".event-email").html(e.find(".event-email").html()),1==e.find(".event-status").html()?this.modalBody.find(".event-status").html('<span class="processing">Đang xử lý</span>'):2==e.find(".event-status").html()?this.modalBody.find(".event-status").html('<span class="updated">Đã cập nhật số Cas thực tế</span>'):4==e.find(".event-status").html()?this.modalBody.find(".event-status").html('<span class="update-acc">Đã cập nhật doanh thu</span>'):this.modalBody.find(".event-status").html('<span class="processed">Đã xử lý</span>'),this.modalBody.find(".event-quantity").html(e.find(".event-quantity").html()),this.modalBody.find(".event-draft").html(e.find(".event-quantity-draft").html()+" Cas"),this.modalBody.find(".event-noteKtv").html(e.find(".event-note-ktv").html()),this.modalBody.find(".event-accountant-doctor-read").html(e.find(".event-accountant-doctor-read").text()),this.modalBody.find(".event-35X43").html(e.find(".event-35X43").text()),this.modalBody.find(".event-polime").html(e.find(".event-polime").text()),this.modalBody.find(".event-8X10").html(e.find(".event-8X10").text()),this.modalBody.find(".event-10X12").html(e.find(".event-10X12").text()),this.modalBody.find(".event-accountant-note").html(e.find(".event-accountant-note").text()),this.modalBody.find(".event-delivery-date").html(e.find(".event-delivery-date").text());var l=e.find(".event-total-file-path").text(),m=e.find(".event-total-file").text();if(""!=l||""!=m?this.modalBody.find(".event-total-file").html((function(){return'<div class="section-file">'+('<input type="hidden" name="path" value="'+l+'"><input type="hidden" name="file" value="'+m+'"><div class="main-file"><div class="file-content"><div class="file-name">'+m+'</div><div class="file-action"><a href="https://drive.google.com/file/d/'+l+'/view"target="_blank" class="download-file"><i class="far fa-eye"></i></a></div></div></div>')+"</div>"})):this.modalBody.find(".event-total-file").html(""),s.getTime()>o.getTime()?this.modalBody.find(".rs-overlay-change").html("<a href="+e.find(".event-route-edit").text()+' target="_blank" class="form-button button-submit rs-lookup-submit">Chỉnh sửa</a>'):this.modalBody.find(".rs-overlay-change").html(""),this.element.addClass("modal-is-open"),setTimeout((function(){e.parent("li").addClass("selected-event")}),10),"mobile"==d)a.modal.one(n,(function(){a.modal.off(n),a.animating=!1}));else{var r=e.offset().top-t(window).scrollTop(),f=e.offset().left,c=t(window).width(),v=t(window).height(),p=.8*c>a.modalMaxWidth?a.modalMaxWidth:.8*c,u=.8*v>a.modalMaxHeight?a.modalMaxHeight:.8*v,g=parseInt((c-p)/2-f),y=parseInt((v-u)/2-r);a.modal.css({top:r+"px",left:f+"px",height:u+"px",width:p+"px"}),h(a.modal,"translateY("+y+"px) translateX("+g+"px)"),a.modalHeaderBg.one(n,(function(){a.modalHeaderBg.off(n),a.animating=!1,a.element.addClass("animation-completed")}))}i||a.modal.add(a.modalHeaderBg).trigger(n)},a.prototype.closeModal=function(e){var a=this,d=a.mq();if(this.animating=!0,t("body").removeAttr("style"),"mobile"==d)this.element.removeClass("modal-is-open"),this.modal.one(n,(function(){a.modal.off(n),a.animating=!1,a.element.removeClass("content-loaded"),e.removeClass("selected-event")}));else{var o=e.offset().top-t(window).scrollTop(),s=e.offset().left,l=e.innerHeight(),m=e.innerWidth(),r=Number(a.modal.css("top").replace("px","")),f=s-Number(a.modal.css("left").replace("px","")),c=o-r;a.element.removeClass("animation-completed modal-is-open"),this.modal.css({width:m+"px",height:l+"px"}),h(a.modal,"translateX("+f+"px) translateY("+c+"px)"),h(a.modalBodyBg,"scaleX(0) scaleY(1)"),h(a.modalHeaderBg,"scaleY(1)"),this.modalHeaderBg.one(n,(function(){a.modalHeaderBg.off(n),a.modal.addClass("no-transition"),setTimeout((function(){a.modal.add(a.modalHeader).add(a.modalBody).add(a.modalHeaderBg).add(a.modalBodyBg).attr("style","")}),10),setTimeout((function(){a.modal.removeClass("no-transition")}),20),a.animating=!1,a.element.removeClass("content-loaded"),e.removeClass("selected-event")}))}i||a.modal.add(a.modalHeaderBg).trigger(n)},a.prototype.mq=function(){return window.getComputedStyle(this.element.get(0),"::before").getPropertyValue("content").replace(/["']/g,"")},a.prototype.checkEventModal=function(e){this.animating=!0;var n=this,i=this.mq();if("mobile"==i)n.modal.add(n.modalHeader).add(n.modalHeaderBg).add(n.modalBody).add(n.modalBodyBg).attr("style",""),n.modal.removeClass("no-transition"),n.animating=!1;else if("desktop"==i&&n.element.hasClass("modal-is-open")){n.modal.addClass("no-transition"),n.element.addClass("animation-completed");var a=n.eventsGroup.find(".selected-event"),d=(a.offset().top,t(window).scrollTop(),a.offset().left,a.innerHeight(),a.innerWidth(),t(window).width()),o=t(window).height(),s=.8*d>n.modalMaxWidth?n.modalMaxWidth:.8*d,l=.8*o>n.modalMaxHeight?n.modalMaxHeight:.8*o;setTimeout((function(){n.modal.css({width:s+"px",height:l+"px",top:o/2-l/2+"px",left:d/2-s/2+"px"}),h(n.modal,"translateY(0) translateX(0)")}),10),setTimeout((function(){n.modal.removeClass("no-transition"),n.animating=!1}),20)}};var d=t(".cd-schedule"),o=[],s=!1;function l(){o.forEach((function(e){e.scheduleReset()})),s=!1}function m(e){var t=(e=e.replace(/ /g,"")).split("/");return 60*parseInt(t[0])}function h(e,t){e.css({"-moz-transform":t,"-webkit-transform":t,"-ms-transform":t,"-o-transform":t,transform:t})}d.length>0&&d.each((function(){o.push(new a(t(this)))})),t(window).on("resize",(function(){s||(s=!0,window.requestAnimationFrame?window.requestAnimationFrame(l):setTimeout(l))})),t(window).keyup((function(e){27==e.keyCode&&o.forEach((function(e){e.closeModal(e.eventsGroup.find(".selected-event"))}))}))}))}schedule(day),$(".select-month").on("change",(function(){var e=$(this).val(),t=$(".select-year").val();$(".loader-over").fadeIn(),$.ajax({url:url_select_sales,method:"POST",data:{_token:$('meta[name="csrf-token"]').attr("content"),year:t,month:e},success:function(e){schedule(e.day),$(".schedule").html(e.html),$(".loader-over").fadeOut()},error:function(e){popupNotificationSessionExpired()},complete:function(){$(".loader-over").fadeOut()}})})),$(".select-year").on("change",(function(){$(".define-month").prop("selected",!0)}));