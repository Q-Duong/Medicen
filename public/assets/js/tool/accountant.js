var typingTimer,doneTypingInterval=600;function quantityFunction(a){var t=a.target.name;$("input[name="+t+"]").on({keyup:function(){formatQuantity($(this))},input:function(){var a=t.split("_")[2],n=$("input[name="+t+"]").val(),e=$(".order_cost_"+a).val();if(""!=n&&""!=e){var r=e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,""),o=parseInt(n)*parseInt(r),c=new Intl.NumberFormat("vi-VN").format(o);$(".order_price_"+a).val(c)}else $(".order_price_"+a).val(0)}})}function costFunction(a){var t=a.target.name;$("input[name="+t+"]").on({keyup:function(){formatCurrency($(this))},blur:function(){formatCurrency($(this),"blur")},input:function(){var a=t.split("_")[2],n=$(".order_quantity_"+a).val(),e=$("input[name="+t+"]").val();if(""!=n&&""!=e){var r=e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,""),o=parseInt(n)*parseInt(r),c=new Intl.NumberFormat("vi-VN").format(o);$(".order_price_"+a).val(c)}else $(".order_price_"+a).val(0);var u=e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"");r=new Intl.NumberFormat("vi-VN").format(u);$(".order_cost_"+a).val(r)}})}function priceFunction(a){var t=a.target.name;$("input[name="+t+"]").on({keyup:function(){formatCurrency($(this))},blur:function(){formatCurrency($(this),"blur")},input:function(){var a=t.split("_")[2],n=$(this).val().replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,""),e=new Intl.NumberFormat("vi-VN").format(n);$(".order_price_"+a).val(e)}})}function amountPaidFunction(a){var t=a.target.name;$("input[name="+t+"]").on({keyup:function(){formatCurrency($(this))},blur:function(){formatCurrency($(this),"blur")},input:function(){var a=t.split("_")[3],n=$(".order_price_"+a).val(),e=$(this).val();if(""!=e&&""!=n){var r=n.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,""),o=e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,""),c=parseInt(r)-parseInt(o),u=new Intl.NumberFormat("vi-VN").format(c);$(".accountant_owe_"+a).val(u)}else $(".accountant_owe_"+a).val(n);var i=e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"");o=new Intl.NumberFormat("vi-VN").format(i);$(".accountant_amount_paid_"+a).val(o)}})}function discountFunction(a){var t=a.target.name,n=t.split("_")[2];$("input[name="+t+"]").on({keyup:function(){formatCurrency($(this))},blur:function(){formatCurrency($(this),"blur")},input:function(){var a=$(".order_price_"+n).val(),t=$(this).val(),e=a.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"");if(""!=t&&""!=a){var r=t.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,""),o=parseInt(e)-parseInt(r),c=new Intl.NumberFormat("vi-VN").format(o);$(".order_profit_"+n).val(c)}else $(".order_profit_"+n).val(a);var u=t.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"");r=new Intl.NumberFormat("vi-VN").format(u);$(".order_discount_"+n).val(r)},click:function(){var a=$(".order_price_"+n).val(),t=$(this).val(),e=a.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"");if(""!=t&&""!=a){var r=t.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,""),o=parseInt(e)-parseInt(r),c=new Intl.NumberFormat("vi-VN").format(o);$(".order_profit_"+n).val(c)}else $(".order_profit_"+n).val(a);var u=t.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"");r=new Intl.NumberFormat("vi-VN").format(u);$(".order_discount_"+n).val(r)}})}function ordFormFunction(a){var t=a.target.name,n=t.split("_")[2];$("input[name="+t+"]").on("keyup change",(function(){var a=$(this).val(),t=$(".accountant_35X43_"+n).val(),e=$(".order_quantity_"+n).val();if("ko in"==a){if(""==t)var r=0;else r=t;var o=4*parseInt(r);$(".accountant_film_bag_"+n).val(o)}else $(".accountant_film_bag_"+n).val(e)}))}function accountant35X43Function(a){var t=a.target.name,n=t.split("_")[2];$("input[name="+t+"]").on("keyup change",(function(){var a=$(this).val(),t=$(".ord_form_"+n).val(),e=$(".order_quantity_"+n).val();if("ko in"==t)if(""!=a){var r=4*parseInt(a);$(".accountant_film_bag_"+n).val(r)}else $(".accountant_film_bag_"+n).val(0);else $(".accountant_film_bag_"+n).val(e)}))}function deadlineFunction(a){var t=a.target.name,n=t.split("_")[2];$("input[name="+t+"]").on("keyup change click",(function(){var a=parseInt($(this).val()),t=$(".accountant_date_"+n).val();if(""!=t){var e=t.split("/"),r=e[2]+"-"+e[1]+"-"+e[0];const c=new Date(r),u=c.getDate()+a;c.setDate(u);var o=c.toLocaleDateString("en-GB",{day:"numeric",month:"numeric",year:"numeric"}).split(" ").join("-");$(".accountant_payment_"+n).val(o)}else $(".accountant_payment_"+n).val("")}))}function dateFunction(a){var t=a.target.name,n=t.split("_")[2];$("input[name="+t+"]").on("keyup change",(function(){var a=$(this).val(),t=$(".accountant_deadline_"+n).val();if(""!=t&&a.length>=10){var e=a.split("/"),r=e[2]+"-"+e[1]+"-"+e[0];const c=new Date(r),u=c.getDate()+parseInt(t);c.setDate(u);var o=c.toLocaleDateString("en-GB",{day:"numeric",month:"numeric",year:"numeric"}).split(" ").join("-");$(".accountant_payment_"+n).val(o)}else $(".accountant_payment_"+n).val("")}))}function getValues(a){return[{name:"accountant_id",value:$('input[name="accountant_id_'+a+'"]').val()},{name:"accountant_deadline",value:$('input[name="accountant_deadline_'+a+'"]').val()},{name:"accountant_number",value:$('input[name="accountant_number_'+a+'"]').val()},{name:"accountant_date",value:$('input[name="accountant_date_'+a+'"]').val()},{name:"order_vat",value:$('input[name="order_vat_'+a+'"]').val()},{name:"order_quantity",value:$('input[name="order_quantity_'+a+'"]').val()},{name:"order_cost",value:$('input[name="order_cost_'+a+'"]').val()},{name:"order_price",value:$('input[name="order_price_'+a+'"]').val()},{name:"accountant_payment",value:$('input[name="accountant_payment_'+a+'"]').val()},{name:"accountant_day_payment",value:$('input[name="accountant_day_payment_'+a+'"]').val()},{name:"accountant_method",value:$('input[name="accountant_method_'+a+'"]').val()},{name:"accountant_amount_paid",value:$('input[name="accountant_amount_paid_'+a+'"]').val()},{name:"accountant_owe",value:$('input[name="accountant_owe_'+a+'"]').val()},{name:"order_percent_discount",value:$('input[name="order_percent_discount_'+a+'"]').val()},{name:"order_discount",value:$('input[name="order_discount_'+a+'"]').val()},{name:"accountant_discount_day",value:$('input[name="accountant_discount_day_'+a+'"]').val()},{name:"order_profit",value:$('input[name="order_profit_'+a+'"]').val()},{name:"accountant_doctor_read",value:$('input[name="accountant_doctor_read_'+a+'"]').val()},{name:"accountant_doctor_date_payment",value:$('input[name="accountant_doctor_date_payment_'+a+'"]').val()},{name:"accountant_35X43",value:$('input[name="accountant_35X43_'+a+'"]').val()},{name:"accountant_polime",value:$('input[name="accountant_polime_'+a+'"]').val()},{name:"accountant_8X10",value:$('input[name="accountant_8X10_'+a+'"]').val()},{name:"accountant_10X12",value:$('input[name="accountant_10X12_'+a+'"]').val()},{name:"accountant_film_bag",value:$('input[name="accountant_film_bag_'+a+'"]').val()},{name:"accountant_note",value:$('input[name="accountant_note_'+a+'"]').val()}]}function getListAccountant(a){$.ajax({url:url_get_accountant,method:"POST",async:!0,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{year:a},beforeSend:function(){}}).then((function(a){$(".table-content").html(a.html)})).always((function(){$(".loader-over").fadeOut()}))}function doneTyping(){var a=$(".search_target1").val(),t=$(".search_target5").val(),n=$(".search_target6").val(),e=$(".search_target7").val();$.ajax({url:url_filter_accountant,method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{month:a,unitCode:t,unitName:n,ctyName:e},success:function(a){var t=new Intl.NumberFormat("vi-VN").format(a.total_price),n=new Intl.NumberFormat("vi-VN").format(a.total_owe),e=new Intl.NumberFormat("vi-VN").format(a.total_amount_paid),r=new Intl.NumberFormat("vi-VN").format(a.total_quantity),o=new Intl.NumberFormat("vi-VN").format(a.total_discount);$("#total-price").text(t),$("#total-owe").text(n),$("#total-amount-paid").text(e),$("#total-quantity").text(r),$("#total-discount").text(o),$(".loader-over").fadeOut()}})}$(document).ready((function(){setTimeout((function(){getListAccountant()}),1e3)})),$(".order_profit").on({keyup:function(){formatCurrency($(this))},blur:function(){formatCurrency($(this),"blur")},input:function(){var a=$(this).val();if(""==a){var t=0;$(".order_profit").val(t)}else t=a.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"")}}),$(".year-filter").on("change",(function(){$(".loader-over").fadeIn(),getListAccountant($(this).val())})),$(document).on("click",".updateAccount",(function(){var a=$(this).data("id"),t=getValues(a);t.push({name:"order_id",value:a}),$(".loader-over").fadeIn(),$.ajax({url:url_update_accountant,method:"Patch",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:t,success:function(t){$(".status_id_"+a).html('<span style="color: #00d0e3;">Đã cập nhật doanh thu</span>'),$(".loader-over").fadeOut(),successMsg(t.success)}})})),$(document).on("click",".completeAccount",(function(){var a=$(this).data("id"),t=getValues(a);t.push({name:"order_id",value:a}),$(".loader-over").fadeIn(),$.ajax({url:url_complete_accountant,method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:t,success:function(t){$(".status_id_"+a).html('<span style="color: #0071e3;">Đã xử lý</span>'),$(".update-account-"+a).html(""),$(".loader-over").fadeOut(),successMsg(t.success)}})})),$(document).on("keyup",".search_target1, .search_target5, .search_target6, .search_target7",(function(){clearTimeout(typingTimer),typingTimer=setTimeout(doneTyping,doneTypingInterval)})),$(document).on("keydown",".search_target1, .search_target5, .search_target6, .search_target7",(function(){clearTimeout(typingTimer)}));